<%- include('../header') -%>
<main role="main" id="contenu">
    <div class="fr-container fr-mb-8w">
        <%- include('../global_components/ariane', { items: [
                { label: 'Accueil', url: '/' },
                { label: 'Admin', url: "/admin" },
                { label: 'Liste des utilisateurs' },
            ],})
            -%>
            <div class="fr-grid-row fr-grid-row--center fr-grid-row--gutters">
                <div class="fr-col fr-col-lg-12">
                    <div class="fr-table">
                        <table>
                            <caption>Liste des utilisateurs : </caption>
                            <thead>
                                <tr>
                                    <th scope="col">Email</th>
                                    <th scope="col">Roles</th>
                                    <th scope="col">Actif</th>
                                    <th scope="col">Reset link</th>
                                    <th scope="col">Date du token de reset</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% for(let i = users.length -1 ; i > 0; i-- ) { %>
                                    <% const user = users[i];%> 
                                    <tr>
                                        <td><%-user.email%></td>
                                        <td><%-user.roles.join(" - ")%></td>
                                        <td><%-user.active ? "Oui" : "Non"%></td>
                                        <td>
                                            <% if (user.resetToken) { %>
                                                <a href="/auth/reset-password/<%-user.resetToken%>?active=true" class="fr-link" target="_blank">Copier moi !</a>
                                            <% } %>
                                        </td>
                                        <td>
                                            <% if (user.resetTokenDate) { %>
                                                <%-helper.date.formatDateWithHour(user.resetTokenDate)%>
                                            <% } %>
                                        </td>
                                    </tr>
                                <% } %>
                            </tbody>
                        </table>
                </div>
            </div>
        </div>
    </div>
</main>
<%- include('../footer') -%>